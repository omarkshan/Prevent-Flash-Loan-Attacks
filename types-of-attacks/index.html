<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 2.25.3"/><title data-react-helmet="true"></title><style data-styled="" data-styled-version="5.2.1">.CWDxU{text-align:left;margin:1em 0;padding:0.5em;overflow:auto;}/*!sc*/
data-styled.g1[id="CodeBlock__Pre-v7tozj-0"]{content:"CWDxU,"}/*!sc*/
.cCevCI{display:table-row;}/*!sc*/
data-styled.g2[id="CodeBlock__Line-v7tozj-1"]{content:"cCevCI,"}/*!sc*/
.cHEauq{display:table-cell;text-align:right;padding-right:1em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;opacity:0.5;}/*!sc*/
data-styled.g3[id="CodeBlock__LineNo-v7tozj-2"]{content:"cHEauq,"}/*!sc*/
.hvRYIH{display:table-cell;}/*!sc*/
data-styled.g4[id="CodeBlock__LineContent-v7tozj-3"]{content:"hvRYIH,"}/*!sc*/
</style><link rel="icon" href="/Prevent-Flash-Loan-Attacks/favicon-32x32.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a" type="image/png"/><link rel="manifest" href="/Prevent-Flash-Loan-Attacks/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/Prevent-Flash-Loan-Attacks/icons/icon-48x48.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a"/><link rel="apple-touch-icon" sizes="72x72" href="/Prevent-Flash-Loan-Attacks/icons/icon-72x72.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a"/><link rel="apple-touch-icon" sizes="96x96" href="/Prevent-Flash-Loan-Attacks/icons/icon-96x96.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a"/><link rel="apple-touch-icon" sizes="144x144" href="/Prevent-Flash-Loan-Attacks/icons/icon-144x144.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a"/><link rel="apple-touch-icon" sizes="192x192" href="/Prevent-Flash-Loan-Attacks/icons/icon-192x192.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a"/><link rel="apple-touch-icon" sizes="256x256" href="/Prevent-Flash-Loan-Attacks/icons/icon-256x256.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a"/><link rel="apple-touch-icon" sizes="384x384" href="/Prevent-Flash-Loan-Attacks/icons/icon-384x384.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a"/><link rel="apple-touch-icon" sizes="512x512" href="/Prevent-Flash-Loan-Attacks/icons/icon-512x512.png?v=4191ad1f07d7f6e74c0032f9ce83bb0a"/><link href="https://fonts.googleapis.com/css?family=Open+Sans:400;600;700&amp;display=swap" rel="stylesheet"/><link as="script" rel="preload" href="/Prevent-Flash-Loan-Attacks/webpack-runtime-a3dfa8ba617821c8c0df.js"/><link as="script" rel="preload" href="/Prevent-Flash-Loan-Attacks/framework-11348fb0fa7c3ad87864.js"/><link as="script" rel="preload" href="/Prevent-Flash-Loan-Attacks/app-9f1a36a3a0d031a1da53.js"/><link as="script" rel="preload" href="/Prevent-Flash-Loan-Attacks/component---src-pages-types-of-attacks-mdx-969f770dc63a6f6977a4.js"/><link as="fetch" rel="preload" href="/Prevent-Flash-Loan-Attacks/page-data/types-of-attacks/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/Prevent-Flash-Loan-Attacks/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><h1>Types of attacks</h1><h2>Oracle Manipulation</h2><p>Also known as Price Oracle Attacks. This seems to be the #1 cause of attacks at the moment, by far. What is important to note, is that decentralized exchanges are not decentralized oracles. Using Uniswap, Sushiswap, or Curve to get pricing information to execute trades is pulling data from potocols whose price depends soley on liquidity. Looking at the infamous ground zero bZx attack that sparked this wave of attacks, we can see exactly what happens. These flash loans are used to crash and manipulate the price of these decentralized exchanges, which most projects deemed safe to use. The issue here relies in the fact that these protocols prices depend entirely on liquidity.</p><p>See the above section for what something like this would look like.</p><h3>Prevention</h3><p>The easiest way to solve this is to use <a href="https://blog.chain.link/flash-loans-and-the-importance-of-tamper-proof-oracles/">decentralized oracles</a>. <a href="https://feeds.chain.link/">Chainlink Price Feeds</a> are the leading decentralized oracle provider, and you can see that the vast majority of the protocols end up adding Chainlink to fix these attacks. If the data (price or otherwise) you&#x27;re looking for isn&#x27;t there yet, you can always request new decentralized networks or <a href="https://docs.chain.link/docs/make-a-http-get-request">build your own</a>.</p><h3>Prevention Example</h3><p>Let&#x27;s take a look at some malicious pseudo-code, pretend these are each ERC20s.</p><div><pre class="CodeBlock__Pre-v7tozj-0 CWDxU prism-code language-javascript" style="background-color:#2a2734;color:#9a86fd"><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">1</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain">uint256 priceOfMyGovernanceTokenInETH </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> dexTokenETHPairPrice</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></span></div><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">2</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain">myGovernanceToken</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">transfer</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> priceOfMyGovernanceTokenInETH</span><span class="token punctuation" style="color:#6c6783">)</span></span></div></pre></div><p>This right here should be the easiest red flag on the planet. If you ever do a transfer based on a centralized price oracle, you&#x27;re asking to get owned. One way or another.</p><p>Check the <a href="https://docs.chain.link/docs/get-the-latest-price">Chainlink documentation for decentralized price feeds</a></p><div><pre class="CodeBlock__Pre-v7tozj-0 CWDxU prism-code language-javascript" style="background-color:#2a2734;color:#9a86fd"><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">1</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token keyword module" style="color:#ffcc99">import</span><span class="token plain"> </span><span class="token string" style="color:#ffcc99">&quot;@chainlink/contracts/src/v0.6/interfaces/AggregatorV3Interface.sol&quot;</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></span></div><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">2</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain"></span><span class="token comment" style="color:#6c6783">// constructor and getLatestPrice function truncated</span><span class="token plain"></span></span></div><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">3</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain">uint256 priceOfMyGovernanceTokenInETH </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">getLatestChainlinkPrice</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></span></div><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">4</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain">myGovernanceToken</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">transfer</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:#6c6783">,</span><span class="token plain"> priceOfMyGovernanceTokenInETH</span><span class="token punctuation" style="color:#6c6783">)</span></span></div></pre></div><h2>Reentrancy</h2><p>A reentrancy attack can occur when you create a function that makes an external call to another untrusted contract before it resolves any effects. If the attacker can control the untrusted contract, they can make a recursive call back to the original function, repeating interactions that would have otherwise not run after the effects were resolved.</p><h3>Prevention</h3><p><code>Send, Transfer, and Call</code></p><h3>Prevention Example</h3><div><pre class="CodeBlock__Pre-v7tozj-0 CWDxU prism-code language-javascript" style="background-color:#2a2734;color:#9a86fd"><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">1</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token keyword" style="color:#ffcc99">function</span><span class="token plain"> </span><span class="token function" style="color:#9a86fd">withdraw</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token plain"> external </span><span class="token punctuation" style="color:#6c6783">{</span><span class="token plain"></span></span></div><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">2</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain">    uint256 amount </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> balances</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></span></div><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">3</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain">    </span><span class="token function" style="color:#9a86fd">require</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">call</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token method function property-access" style="color:#9a86fd">value</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token plain">amount</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">(</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">)</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></span></div><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">4</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain">    balances</span><span class="token punctuation" style="color:#6c6783">[</span><span class="token plain">msg</span><span class="token punctuation" style="color:#6c6783">.</span><span class="token property-access">sender</span><span class="token punctuation" style="color:#6c6783">]</span><span class="token plain"> </span><span class="token operator" style="color:#e09142">=</span><span class="token plain"> </span><span class="token number" style="color:#e09142">0</span><span class="token punctuation" style="color:#6c6783">;</span><span class="token plain"></span></span></div><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">5</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain"></span><span class="token punctuation" style="color:#6c6783">}</span></span></div></pre></div><h2>Pump and Arbitrage</h2><h3>Prevention</h3><h2>Safe Integer use and basic audits</h2><p>Everything that applies to basic contract safety applies to flash loan attack safety. Such as:</p><div><pre class="CodeBlock__Pre-v7tozj-0 CWDxU prism-code language-" style="background-color:#2a2734;color:#9a86fd"><div class="CodeBlock__Line-v7tozj-1 cCevCI token-line" style="color:#9a86fd"><span class="CodeBlock__LineNo-v7tozj-2 cHEauq">1</span><span class="CodeBlock__LineContent-v7tozj-3 hvRYIH"><span class="token plain">using SafeMath for uint256;</span></span></div></pre></div><p>Watch out for integer overflows, etc.</p></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/types-of-attacks/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-2bdc720517636649befc.js"],"app":["/app-9f1a36a3a0d031a1da53.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-8d182377ad7fb53660a4.js"],"component---src-pages-abstract-mdx":["/component---src-pages-abstract-mdx-7883be978259f56f0089.js"],"component---src-pages-historic-attacks-mdx":["/component---src-pages-historic-attacks-mdx-c13c907d0c304aa2754b.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-8c89e213f07edfcd4afa.js"],"component---src-pages-more-details-mdx":["/component---src-pages-more-details-mdx-53209bb66f8e2a441307.js"],"component---src-pages-types-of-attacks-mdx":["/component---src-pages-types-of-attacks-mdx-969f770dc63a6f6977a4.js"],"component---src-pages-what-is-flash-loan-mdx":["/component---src-pages-what-is-flash-loan-mdx-872ac82c799d316e2807.js"]};/*]]>*/</script><script src="/Prevent-Flash-Loan-Attacks/polyfill-2bdc720517636649befc.js" nomodule=""></script><script src="/Prevent-Flash-Loan-Attacks/component---src-pages-types-of-attacks-mdx-969f770dc63a6f6977a4.js" async=""></script><script src="/Prevent-Flash-Loan-Attacks/app-9f1a36a3a0d031a1da53.js" async=""></script><script src="/Prevent-Flash-Loan-Attacks/framework-11348fb0fa7c3ad87864.js" async=""></script><script src="/Prevent-Flash-Loan-Attacks/webpack-runtime-a3dfa8ba617821c8c0df.js" async=""></script></body></html>